<!DOCTYPE html>
<html>
	<head>
	
	<link href="//gmpg.org/xfn/11" rel="profile">
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<link rel="canonical" href="www.slaterstich.com/blog/intro-ant" />
	<meta name="description" content="# Which Primes are Sums of Two Squares? Consider the primes, \\(2, 3, 5, 7, 11, \ldots\\). Which can be..." />
	<meta property="og:description" content="# Which Primes are Sums of Two Squares? Consider the primes, \\(2, 3, 5, 7, 11, \ldots\\). Which can be..." />
	<meta itemprop="image" content="/general-abstract-nonsense/assets/images/blackboard.jpg" />
	<meta property="og:image" content="/general-abstract-nonsense/assets/images/blackboard.jpg" />
	<meta property="og:title" content="Higher Arithmetic" />
	<meta property="og:type" content="article" />
	<meta property="og:url" content="www.slaterstich.com/blog/intro-ant" />
	<meta property="og:site_name" content="New Data Scientist" />
	<title>Higher Arithmetic &middot; New Data Scientist</title>
	<meta name="mobile-web-app-capable" content="yes">
	<meta name="HandheldFriendly" content="True" />
	<meta name="MobileOptimized" content="320" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" type="text/css" media="only screen and (min-width: 900px)" href="/general-abstract-nonsense/assets/css/desktop.css" />
	<link rel="stylesheet" type="text/css" media="only screen and (max-width: 899px)" href="/general-abstract-nonsense/assets/css/mobile.css" />
	<link href="/general-abstract-nonsense/assets/css/genericons.css" type="text/css" rel="stylesheet" />
	<link href="/general-abstract-nonsense/assets/css/syntax.css" type="text/css" rel="stylesheet" />
	<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Fenix:400,400italic">
	<link rel="apple-touch-icon" href="www.slaterstich.com/assets/images/ds-logo.png">
	<link rel="shortcut icon" href="www.slaterstich.com/assets/images/favicon.ico">
	<link rel="alternate" type="application/rss+xml" title="RSS" href="www.slaterstich.com/atom.xml">
	<script type="text/javascript" src="/general-abstract-nonsense/assets/js/jquery-2.1.0.min.js"></script>
	<script type="text/javascript" src="/general-abstract-nonsense/assets/js/jquery.stellar.min.js"></script>

  <!-- Mathjax -->
  <script type="text/javascript"
  src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  <script type="text/javascript">
    MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['\\(','\\)'] ],
      displayMath: [ ['$$','$$'], ['\\[','\\]'] ]
    }
    });
  </script>
  <!-- Google Analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-9517040-39', 'auto');
    ga('send', 'pageview');
  </script>
</head>

	<body>
		<header class="clean" style="background-image: url(/general-abstract-nonsense/assets/images/blackboard.jpg); height: 100%;" data-stellar-background-ratio="0.5" data-stellar-horizontal-offset="50">
	
	<label class="menu" for="_1">
	<span class="genericon genericon-menu"></span>
</label>
<input id="_1" type="checkbox">
<div class="menu-content">
	<p class="menu-title">New Data Scientist<p>
	<div class="menu" style="background-color: #1a1a1a; z-index: -1;"></div>
	
		<a href="/">Home</a>
	
		<a href="/about">About</a>
	
	<hr>
	
		<a href="https://twitter.com/sl8r000" class="social-links-menu" target="_blank" title="Follow me on twitter"><span class="genericon genericon-twitter"></span></a>
	
		<a href="https://github.com/sl8r000" class="social-links-menu" target="_blank" title="Fork me on github"><span class="genericon genericon-github"></span></a>
	
		<a href="https://google.com/+SlaterStich" class="social-links-menu" target="_blank" title="Add me on google+"><span class="genericon genericon-googleplus-alt"></span></a>
	
</div>
<div class="social-links" data-stellar-ratio="0.1">
	
		<a href="https://twitter.com/sl8r000" target="_blank" title="Follow me on twitter"><span class="genericon genericon-twitter"></span></a>
	
		<a href="https://github.com/sl8r000" target="_blank" title="Fork me on github"><span class="genericon genericon-github"></span></a>
	
		<a href="https://google.com/+SlaterStich" target="_blank" title="Add me on google+"><span class="genericon genericon-googleplus-alt"></span></a>
	
</div>

	<div id="post-info" data-stellar-ratio="0.7">
		<h1>Higher Arithmetic</h1>
		
		<a class="site-title" href=""><div class="site-icon-small" style="background-image: url(/assets/images/ds-logo.png);"></div>slater stich</a>, on 12 January 2015
	</div>
	<div id="nav-icon" style="bottom: 30px;" data-stellar-ratio="4">
		<a class="scroll" data-speed="500" href="#article"><span class="genericon genericon-expand"></span></a>
	</div>
</header>
<div id="middle">
	<div id="article">
		<h1 id="which-primes-are-sums-of-two-squares">Which Primes are Sums of Two Squares?</h1>
<p>Consider the primes, \(2, 3, 5, 7, 11, \ldots\). Which can be written as a sum of two squared integers? The prime \(2\) can, since \(2 = 1^2 + 1^2\). But \(3\) cannot, since \(3 &gt; 1^2 + 1^2\) and \(3 &lt; 1^2 + 2^2\). What about the rest? Let’s start a table:</p>

<table>
  <thead>
    <tr>
      <th>prime</th>
      <th>sum of two squares?</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2</td>
      <td>\(1^2 + 2^2\)</td>
    </tr>
    <tr>
      <td>3</td>
      <td>no</td>
    </tr>
    <tr>
      <td>5</td>
      <td>\(1^2 + 2^2\)</td>
    </tr>
    <tr>
      <td>7</td>
      <td>no</td>
    </tr>
    <tr>
      <td>11</td>
      <td>no</td>
    </tr>
    <tr>
      <td>13</td>
      <td>\(3^2 + 2^2\)</td>
    </tr>
    <tr>
      <td>17</td>
      <td>\(4^2 + 1^2\)</td>
    </tr>
    <tr>
      <td>19</td>
      <td>no</td>
    </tr>
    <tr>
      <td>23</td>
      <td>no</td>
    </tr>
    <tr>
      <td>29</td>
      <td>\(5^2 + 2^2\)</td>
    </tr>
    <tr>
      <td>31</td>
      <td>no</td>
    </tr>
    <tr>
      <td>37</td>
      <td>\(6^2 + 1^2\)</td>
    </tr>
    <tr>
      <td>41</td>
      <td>\(4^2 + 5^2\)</td>
    </tr>
    <tr>
      <td>43</td>
      <td>no</td>
    </tr>
  </tbody>
</table>

<p>Here’s where things get interesting: There’s a very simple rule that determines whether a prime is a sum of two squares, a rule that first seems <em>entirely unrelated</em> to primes <em>or</em> squares. Look at the remainders modulo \(4\); if you haven’t seen this bit of mathematics before, it’s worth taking a moment to do a few computations and see if you can guess the rule.</p>

<table>
  <thead>
    <tr>
      <th>prime</th>
      <th>sum of two squares?</th>
      <th>remainder modulo 4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2</td>
      <td>\(1^2 + 2^2\)</td>
      <td>\(2\)</td>
    </tr>
    <tr>
      <td>3</td>
      <td>no</td>
      <td>\(3\)</td>
    </tr>
    <tr>
      <td>5</td>
      <td>\(1^2 + 2^2\)</td>
      <td>\(1\)</td>
    </tr>
    <tr>
      <td>7</td>
      <td>no</td>
      <td>\(3\)</td>
    </tr>
    <tr>
      <td>11</td>
      <td>no</td>
      <td>\(3\)</td>
    </tr>
    <tr>
      <td>13</td>
      <td>\(3^2 + 2^2\)</td>
      <td>\(1\)</td>
    </tr>
    <tr>
      <td>17</td>
      <td>\(4^2 + 1^2\)</td>
      <td>\(1\)</td>
    </tr>
    <tr>
      <td>19</td>
      <td>no</td>
      <td>\(3\)</td>
    </tr>
    <tr>
      <td>23</td>
      <td>no</td>
      <td>\(3\)</td>
    </tr>
    <tr>
      <td>29</td>
      <td>\(5^2 + 2^2\)</td>
      <td>\(1\)</td>
    </tr>
    <tr>
      <td>31</td>
      <td>no</td>
      <td>\(3\)</td>
    </tr>
    <tr>
      <td>37</td>
      <td>\(6^2 + 1^2\)</td>
      <td>\(1\)</td>
    </tr>
    <tr>
      <td>41</td>
      <td>\(4^2 + 5^2\)</td>
      <td>\(1\)</td>
    </tr>
    <tr>
      <td>43</td>
      <td>no</td>
      <td>\(3\)</td>
    </tr>
  </tbody>
</table>

<p>It looks like <strong>a prime \(p\) is a sum of two squares if and only if \(p \neq 3 \mod 4\)</strong>. This, at first, seems pretty weird. What does being a sum of two squares have to do with being \(3\) modulo \(4\)? And what does any of this have to do with primes? To get answers, we’ll have to ascend from the set of integers \(\mathbb{Z}\) to a higher, more “complete” set of integers embedded within the complex numbers \(\mathbb{C}\). This set, called the Gaussian Integers, has its own arithmetic and its own “higher” primes - which will be the key to understanding our two squares problem.</p>

<h1 id="the-gaussian-integers">The Gaussian Integers</h1>

<p>The first key discovery on our path is a rephrasing of the “is a sum of two squares” condition. Consider the complex numbers \(a + bi\) where \(a\) and \(b\) are both integers. This set is called the <strong>Gaussian Integers</strong> and it has many of the same properties that the set of “familiar” integers \(\ldots, -2, -1, 0, 1, 2, \ldots\) has; we’ll get into that in a moment. For now, the key point is that an integer \(n\) is a sum of two squares \(a\) and \(b\) if and only if \(n = (a + bi)(a - bi)\). In other words, being a sum of two squares is equivalent to factorizing as a Gaussian integer and its complex conjugate, \(n = z\cdot \overline{z}\).</p>

<p>This is an important idea. Just a few sentances ago, it was baffling why being a sum of two squares should have anything to do with primes or divisibility. But now we have a clue: Being writable as a sum of two squares in \(\mathbb{Z}\) is related to divisibility in \(\mathbb{Z} + i\mathbb{Z}\), the Gaussian integers.</p>

<p>So what does divisibility in\(\mathbb{Z} + i\mathbb{Z}\) look like? Interestingly, concepts from the integers \(\mathbb{Z}\) carry over nicely. For example:</p>

<ul>
  <li><strong>Divisability:</strong> In \(\mathbb{Z}\) we say that “\(n\) divides \(m\)” when there exists some integer \(k\) such that \(nk = m\). For example, \(6\) divides \(12\) because there exists an integer \(k=2\) such that \(6\cdot 2 = 12\). We write \(n \mid m\) as shorthand for “\(n\) divides \(m\)”. In \(\mathbb{Z} + i\mathbb{Z}\), we use the same definition: For \(\alpha, \beta \in \mathbb{Z} + i\mathbb{Z}\), we say that \(\alpha \mid \beta\) when there exists \(\gamma \in \mathbb{Z} + i \mathbb{Z}\) such that \(\alpha \gamma = \beta\). For example, \(1 + i\) divides \(-2 + 8i\) because \((1 + i)(3 + 5i) = (-2 + 8i)\).</li>
  <li><strong>Primality:</strong> We call an integer \(n \in \mathbb{Z}\) prime if whenever \(n \mid ab\) for \(a, b \in \mathbb{Z}\) (that is, “whenever \(n\) divides \(ab\) for \(a\) and \(b\) in \(\mathbb{Z}\)), we have that \(n \mid a\) or \(n \mid b\). For example, \(3\) is a prime since if \(3\) divides \(ab\), then either \(3\) divides \(a\) or \(3\) divides \(b\); notice that \(6\), a non-prime, doesn’t have this property (for example, \(6\) divides \(2\cdot 3\) but it doesn’t divide \(2\) or \(3\).) In the Gaussian integers, the definition is the same: \(\eta \in \mathbb{Z} + i\mathbb{Z}\) is “prime” if whenever \(\eta \mid \alpha \beta\) for \(\alpha, \beta \in \mathbb{Z} + i\mathbb{Z}\) we have that \(\eta \mid \alpha\) or \(\eta \mid \beta\). For example: \(1 + 2i\) is prime (it’s hard to see why just yet) but \(-2 + 8i = (1 + i)(3+5i)\) is not.</li>
  <li><strong>Prime Factorization:</strong> In \(\mathbb{Z}\), every integer factors as a product of primes in a “pretty much unique” way. For example, \(12 = 2^23 = (-1)^22^23 = (-1)^42^23 = \cdots\). The same fact is true in \(\mathbb{Z} + i\mathbb{Z}\), every member of the set factors “pretty much uniquely” as a product of primes. More precisely, any \(alpha \in \mathbb{Z} + i\mathbb{Z}\) is writable as \(alpha = u\prod_i \pi_i^{e_i}\) where \(u\) is either \(1\), \(-1\), \(i\), or \(-i\), the \(\pi_i\) are all primes in \(\mathbb{Z} + i\mathbb{Z}\), and the \(e_i\) are positive integers (normal integers, not Gaussian integers). This factorization is unique, up to \(u\).</li>
</ul>

<p>As promised, here’s a proof that prime factorization holds in \(\mathbb{Z} + i\mathbb{Z}\), though again: On a first pass, you may want to simply trust this fact and skip to the next section.</p>

<div class="message">\(\mathbb{Z} + i\mathbb{Z}\) is a unique factorization domain.</div>

<blockquote>
  <p>Consider the norm function \(N(a + bi) = \sqrt{a^2 + b^2}\), also known as the complex absolute value. This function is multiplicative: \(N(\alpha \beta) = N(\alpha)N(\beta)\). For \(\eta \in \mathbb{Z} + i\mathbb{Z}\), the value of \(N(\eta)\) is always a non-negative integer. \(N(\eta) = 0\) if and only if \(\eta = 0\), and \(N(\eta) = 1 \) if and only if \(\eta \in \{1, -1, i, -i\}\). So if \(\alpha = \beta \gamma\) for \(\beta\) and \(\gamma\) both nonzero, and both not in \(\{1, -1, i, -i\}\), then \(N(\beta) \leq (\alpha)\) and \(N(\gamma) \leq N(\alpha)\). In other words, if \(\alpha\) factors nontrivially, then the norms of the factors are smaller than the norm of \(\alpha\). This is really the key observation, the one that leads to the proof. For a given \(\alpha \in \mathbb{Z} + i\mathbb{Z}\), either \(\alpha\) is prime or else \(\alpha = \alpha_1\alpha_2\) nontrivially. Either \(\alpha_1\) is prime or \(\alpha_1 = \alpha_{1,1}\alpha_{1,2}\) nontrivially. Either \(\alpha_{1, 1}\) is prime or… etc. Keep factoring until we hit the primes. We have to hit primes eventually since \(N(\alpha) &gt; N(\alpha_1) &gt; N(\alpha_{1,1}) &gt; \cdots &gt; 0\).
More generally, any “domain” with a function like the norm (a “Euclidean function”) is called a Euclidean domain; every Euclidean domain is something called a “principal ideal domain”; every principal ideal domain is a “unique factorization domain”, meaning that prime factorization holds. So all of this can be generalized quite a bit.</p>
</blockquote>

<h1 id="mathbbzs-primes-in-mathbbz--imathbbz">\(\mathbb{Z}\)’s Primes in \(\mathbb{Z} + i\mathbb{Z}\)</h1>

<p>Now that we know about “higher primes” in \(\mathbb{Z} + i\mathbb{Z}\), we can ask an interesting question: What happens to primes in \(\mathbb{Z}\) when we consider them as members of \(\mathbb{Z} + i\mathbb{Z}\)? This makes sense: Indeed, every \(n \in \mathbb{Z}\) is also an element of \(\mathbb{Z} + i\mathbb{Z}\), since \(n = n + 0i \in \mathbb{Z} + i\mathbb{Z}\). We have a notion of “primaility” both in \(\mathbb{Z}\) and in \(\mathbb{Z} + i\mathbb{Z}\). So it’s natural to ask: What happens to \(\mathbb{Z}\)’s primes in \(\mathbb{Z} + i\mathbb{Z}\)? Do they stay prime? Do they factor? It turns out the answer is:</p>

<div class="message">Let \(p \in \mathbb{Z}\) be a prime. In \(\mathbb{Z} + i\mathbb{Z}\),

<ul>
<li>If \(p = \pm 2\), then \(p = (1+i)(1-i)\) is not a prime.</li>
<li>If \(p \equiv 3 \mod 4\), then \(p\) is a prime.</li>
<li>If \(p \equiv 1 \mod 4\), then \(p\) is not a prime, and in fact \(p\) factors as \(p = (a + bi)(a - bi) = a^2 + b^2\).</li>
</ul>

</div>

<p>This theorem is what we’ve been waiting for: <strong>A prime \(p \in \mathbb{Z}\) is writable as a sum of two squares if and only if \(p\) ceases to be a prime in \(\mathbb{Z} + i\mathbb{Z}\)</strong>. And \(p\) is prime in \(\mathbb{Z} + i\mathbb{Z}\) if and only if \(p \neq 3 \mod 4\). So the one-surprising connection between primes, remainders modulo \(4\), and sums of squares is now clear, and we have an answer to our origional question! Here’s a sketch of the proof, done point by point:</p>

<div class="message">
If \(p = \pm 2\), then \(p = (1+i)(1-i)\) is not a prime.
</div>

<blockquote>
  <p>This is clear.</p>
</blockquote>

<div class="message">
If \(p \equiv 3 \mod 4\), then \(p\) is a prime.
</div>

<blockquote>
  <p>Suppose to the contrary that \(p = \alpha \beta\) for \(\alpha, \beta \notin \{1, -1, i, -i\}\). Then \(\alpha = \overline{\beta}\). Indeed, if \(\alpha = a_1 + a_2 i\) and \(\beta = b_1 + b_2 i\), then \(\alpha\beta = a_1 b_1 - a_2 b_2 + (a_1 b_2 + a_2 b_1)i\) is a real number, so \(a_1 b_2 + a_2 b_1 = 0\). This implies that \(a_1 = b_1\) and \(a_2 = - a_2\), as desired. So, if \(p\) factors, then \(p = a^2 + b^2\). But this is impossible since \(p \equiv 3 \mod 4\) and \(a^2 + b^2\) is either \(0\), \(1\), or \(2\) modulo \(4\) for any values of \(a\) and \(b\). Hence we have obtained a contradiction from the assumption that \(p = \alpha \beta\) for \(\alpha, \beta \notin \{1, -1, i, -i\}\), so this assumption must be incorrect and hence \(p\) is prime.</p>
</blockquote>

<div class="message">
If \(p \equiv 3 \mod 4\), then \(p\) is not a prime, and in fact \(p\) factors as \(p = (a + bi)(a - bi) = a^2 + b^2\).
</div>

<blockquote>
  <p>This is the most difficult part of the proof, and I’ll omit a full discussion. The breakthrough observation is that if \(p = 1 + 4n\), then \(p\) divides \(m^2 + 1\) for \(m = (2n)!\) (Wilson’s theorem). So \(p \mid (m+i)(m-i)\). But \(p\) does not divide \(m+i\) or \(m-i\) since \(p\) divides neither \(i\) nor \(m = (2n)!\) Hence \(p\) is not prime.</p>
</blockquote>

<h1 id="going-further">Going Further</h1>

<p>We saw that the Gaussian integers \(\mathbb{Z} + i\mathbb{Z}\) were extremely useful in answering questions that, at first, seemed to solely be about \(\mathbb{Z}\). One might wonder whether there are other “higher integers” that could be similarly useful. Indeed there are! A branch of mathematics called “algebraic number theory” is partially about these higher integers and their relationship with the familiar integers \(\mathbb{Z}\).</p>

<p>We’ve already seen one interesting way in which the “higher integers” interact with \(\mathbb{Z}\): The primes in \(\mathbb{Z}\) either remain prime or “split” when we ascend to \(\mathbb{Z} + i\mathbb{Z}\). Analysis of this sort of prime “ramification” in a higher number ring is a common pattern in algebraic number theory. Another general pattern is symmetry in the roots of polynomials over \(\mathbb{Z}\). We caught a glimpse of this when we talked about the norm function, but there’s a <em>lot</em> more out there in a field of mathematics called Galois theory. For a short introduction, check out this <a href="https://www.youtube.com/watch?v=FfVR4O__LXY">short video series by yours truly</a>. Another pattern is a sort of topological, geometric perspective: “higher integers” over \(\mathbb{Z}\) are akin to functions between topological spaces like spheres, paths, tori, etc. <a href="http://en.wikipedia.org/wiki/Ramification">Really!</a> This is a very deep part of mathematics called “arithmetic geometry”. Other patterns with which I am less familiar, e.g. class field theory, abound as well!</p>

        </div>
	
</div>

	

<footer class="" style="background-image: url(/general-abstract-nonsense/general-abstract-nonsense/assets/images/blackboard.jpg); height: 75%; min-height: 500px;" data-stellar-background-ratio="0.5" data-stellar-horizontal-offset="50" data-stellar-vertical-offset="50">
	<div id="nav-icon" style="top: 60px;" data-stellar-ratio="0.8">
		<a class="scroll" data-speed="500" href="#article"><span class="genericon genericon-collapse"></span></a>
	</div>
	<div id="post-info" data-stellar-ratio="0.5" data-stellar-vertical-offset="120">
		<h3></h3>
                <a href="/general-abstract-nonsense">
			<h1></h1>
			
		</a>
	</div>
	<p class="copyright">Theme by <a href="http://camporez.com" target="_blank">Camporez</a>. <a href="http://creativecommons.org/licenses/by-nc/2.5" target="_blank">Some rights reserved</a>.</p>
</footer>
<script src="/general-abstract-nonsense/assets/js/smooth-scroll.js"></script>

		<script>
		var width = $(window).width()
		if ( width > 899 )
		$( function(){
		    $.stellar({
		    	responsive: true,
			verticalScrolling: true,
			horizontalOffset: 0,
			verticalOffset: 0,
			positionProperty: 'transform',
		    });
		});
		</script>
	</body>
</html>
